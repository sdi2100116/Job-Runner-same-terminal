Πληροφορίες για το πρόγραμμα:

Αρχικά τα εκτελέσιμα δημιουργούνται κάνοντας make jobCommander jobExecutorServer progDelay .
Θα δημιουργηθούν μέσα στον φάκελο bin. Άρα τρέχουν γράφοντας bin/jobCommander ... ,bin/jobExecutor server ... ,bin/progDelay ... . Επίσης διαγράφονται όλα με make clean.

Έχω φτιάξει μερικά tests στον φάκελο tests που τρέχουν γράφοντας tests/test_X.sh. Σε κάθε test αναφέρω ποια είναι τα αναμενόμενα αποτελέσματα. Τα test τρέχουν τις περισσότερες εντολές και τον server στο background ωστε να είναι δυνατόν να τρέχουν σε ένα terminal. 
🚨Προσοχή: μετά απο κάθε test -που δεν τελειώνει με την εντολή bin/jobCommander linux08 2021 exit- να τρέχετε την εντολή bin/jobCommander linux08 2021 exit ωστέ να τερματίσει ο server.🚨

jobCommander.c: Ο jobCommander αρχικά δέχεται ως input την εντολή που δίνει ο πελάτης. Ελέγχει αν η εντολή που δόθηκε είναι συντακτικά ορθη  -αν δεν είναι επιστρέφει 1-, ανοίγει ένα socket και συνδεέται στον server που θα είναι ενεργός. Μετά διαβάζει επαναλαμβανόμενα ανα 50 bytes ότι του στέλνει ο server μέχρι να κλείσει το socket και να τελειώσει

jobExecutorServer.c: Ο jobExecutorServer αρχικά αρχικοποιεί όλες τις μεταβλητές που χρείαζονται, δημιουργεί τον buffer και τα worker threads,τα οπόια μπλοκάρονται με το που ξεκινήσει ο σερβερ, με βασει τις τιμές που του έδωσε ο χρήστης και μπάινει σε έναν ατέρμονο βρόχο μέχρι ο πελάτης να του δώσει την εντολή exit. Μέσα στον ατέρμονο βρόγχο δέχεται συνδέσεις και κάθε μία σύνδεση την διαχείρίζεται με ένα νέο thread (controller thread). 

jobExecutorServerImplementation.c: Μέσα στον αρχείο αυτό βρίσκονται οι συναρτήσεις των threads (controller_thread_act,worker_thread_act) καθώς και κάποιες άλλες συναρτήσεις που χρησιμοποιούνται. 
    Controler threads: Αρχικά τα controller thread δέχονται το input του χρήστη και ανάλογα τι είναι εκτέλουν έναν συγκεκριμένο κώδικα. Αν η εντολή του χρήστη είναι issueJob τότε επιστρέφεται ένα μήνμα στον client, δημιουργείται η διεργασία ως ενα struct triplet που έχει μέσα το jobID,το job και το socket του client που έστειλε την διεργασία και μπάινει στον κυκλικό buffer. Αν το Concurrency το επιτρέπει τότε η εντολή μπαίνει για εκτέλεση σε WorkerThread ξεμπλοκάροτας το. Η λειτουργία των worker thread θα αναλυθεί σε λιγάκι. Αν ο client δώσει την εντολή setConcurrency τότε επιστρέφεται στον client οτι το concurrency άλλαξε επιτυχώς και αμέσως μετά αν το καινούριο concurrency είναι μεγαλύτερο απο το προηγούμενο,ξυπνάει νεο concurrency-παλιο concurrency worker threads, ωστε πλέον να λειτουργουν concurrency worker threads. Αν ο client δώσει την εντολή stop, τότε καλείται η συνάρτηση του κυκλικού buffer που ελέγχει αν μία διεργασία βρίσκεται μέσα του και αν υπάρχει την αφαιρεί. Αν την αφαιρέσει κανονικά επιστρέφεται στον client ότι η διεργασία αφαιρέθηκε αλλιώς επιστρέφεται οτι η διεργασία δεν βρέθηκε. Αν ο client δώσει την εντολή poll τότε για κάθε διεργασία στον κυκλικό buffer, επιστρέφεται η τριπλέτα της, διαμορφώνεται σε μορφη μηνύματος και επιστρέφεται στον client. Τέλος αν ο client δώσει την εντολή exit τότε αφαιρείται κάθε διεργασία στον buffer,καθώς και αυτές που περιμένουν να μπουν(είναι μπλοκαρισμένες), και στέλνεται στο socket του αντιστοιχου client SERVER TERMINATED BEFORE EXECUTION, μετά περιμένει να τελείωσουν όλες οι διεργασίες που τρέχουν εκείνη τη στιγμή και αφότου τελειώσουν στέλνει σήμα στο server για να τερματίσει. Ο server για να τερμάτιστει κλέινει το socket του μέσα στον signal handler ώστε όταν πάει να γίνει η accept να δώσει error και έτσι να τερμάτισουμε τον server μέσα στην error handling την accept. Αν δεν γινόταν αυτό και άλλαζε κατευθείαν η μεταβλητή μεσα στον signal handler θα μπλόκαρε στην accept και ο server δεν θα τερμάτιζε.

    Worker threads: Τα worker threads με το που δημιουργηθούν μπλοκάρονται με condition variables. Όταν σταλθεί σήμα για να ξεμπλοκαριστούν αφαιρείται η πρώτη διεργασία απο τον buffer και γίνεται μια fork(). Η διεργασία παιδί δημιουργεί ένα αρχείο pid.output και με την dup2() κάνει ανακατεύθυνση την έξοδο της οθόνης στην έξοδο του αρχείου που δημιούργησε. Μπαίνει η διεργασία μαζί με όλα της τα ορίσματα σε ένα array και τρέχει με την εντολή execvp. Η διεργασία γονέας διαβάζει απο το αρχείο την δίεργασία και με κάποιες παραμορφώσεις(jobID output start-end) γράφει την εργασία στο socket του πελάτη που την έιχε στείλει, κλείνει το socket και σβήνει το αρχείο. Τέλος αν ο buffer δεν είναι άδειος και τα worker threads είναι λιγότερα απο το τρέχων concurrency ξεμπλοκάρει κάποιο worker thread για να ξεκινήσει η επόμενη διεργασία απο τον buffer.


buffer.c: Η δομή που έχω επιλέξει για buffer έιναι ένας κυκλικός buffer. Οι λειτουργίες του είναι η εισαγωγή στοιχείων, εξαγωγή πρώτου στοιχείου και η αναζήτηση και η εξαγωγή συγκεκριμένου στοιχείου. Το array της δομής buffer έχει μέσα την δομή triplet που όπως προανέφερα με αυτή την δομή αποθηκέυουμε τις διεργασίες.
